<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Textile Time Travel AR</title>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://cdn.rawgit.com/jeromeetienne/AR.js/2.2.1/aframe/build/aframe-ar.js"></script>
    <style>
      body { margin: 0; overflow: hidden; }
      #info {
        position: absolute;
        top: 10px; left: 10px;
        background: rgba(255,255,255,0.8);
        padding: 10px;
        font-family: sans-serif;
        z-index: 1;
      }
      #sidebar {
        position: absolute;
        right: -320px; /* hidden by default */
        top: 0;
        width: 320px;
        height: 100%;
        background: rgba(255,255,255,0.95);
        padding: 20px;
        font-family: sans-serif;
        transition: right 0.3s ease;
        z-index: 2;
        overflow-y: auto;
      }
      #sidebar.open { right: 0; }
      #toggleBtn {
        position: absolute;
        top: 10px; right: 10px;
        z-index: 3;
        padding: 8px 12px;
        background: #333; color: #fff;
        border: none; cursor: pointer;
      }
    </style>
  </head>
  <body>
    <div id="info">
      <strong>AR Textile Cards</strong><br>
      Print or display these markers:<br>
      <a href="markers/spinning.png" target="_blank">Spinning marker</a> |
      <a href="markers/dyeing.png" target="_blank">Dyeing marker</a> |
      <a href="markers/weaving.png" target="_blank">Weaving marker</a>
    </div>

    <button id="toggleBtn" onclick="toggleSidebar()">Show Info</button>
    <div id="sidebar">
      <h3>Task Details</h3>
      <p id="caption">Point your camera at a marker to see details here.</p>
    </div>

    <a-scene embedded arjs="sourceType: webcam; debugUIEnabled: false;">
      <!-- Preload videos -->
      <a-assets>
        <video id="spinning" src="assets/videos/spinning.mp4" loop muted></video>
        <video id="dyeing" src="assets/videos/dyeing.mp4" loop muted></video>
        <video id="weaving" src="assets/videos/weaving.mp4" loop muted></video>
      </a-assets>

      <!-- Spinning marker -->
      <a-marker type="pattern" url="markers/spinning.patt">
        <a-video src="#spinning" width="2" height="1" position="0 0 0"></a-video>
        <a-entity
          text="value: Spinning: Took ~2 hours. Fibers twisted into yarn for strength and usability.; width: 3; color: black"
          position="0 -1 0">
        </a-entity>
      </a-marker>

      <!-- Dyeing marker -->
      <a-marker type="pattern" url="markers/dyeing.patt">
        <a-video src="#dyeing" width="2" height="1" position="0 0 0"></a-video>
        <a-entity
          text="value: Dyeing: Took ~1 hour. Threads colored to add vibrancy and protect fibers.; width: 3; color: black"
          position="0 -1 0">
        </a-entity>
      </a-marker>

      <!-- Weaving marker -->
      <a-marker type="pattern" url="markers/weaving.patt">
        <a-video src="#weaving" width="2" height="1" position="0 0 0"></a-video>
        <a-entity
          text="value: Weaving: Took ~3 hours. Threads interlaced to form durable, patterned fabric.; width: 3; color: black"
          position="0 -1 0">
        </a-entity>
      </a-marker>

      <!-- Camera -->
      <a-entity camera></a-entity>
    </a-scene>

    <script>
      function toggleSidebar() {
        const sidebar = document.getElementById('sidebar');
        sidebar.classList.toggle('open');
        const btn = document.getElementById('toggleBtn');
        btn.textContent = sidebar.classList.contains('open') ? 'Hide Info' : 'Show Info';
      }
    </script>
  </body>
</html>